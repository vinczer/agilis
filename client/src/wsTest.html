<!DOCTYPE html>
<html>
  <head>
    <title>
      WS Test
    </title>
  </head>

  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>

    <script>
      $(document).ready(function() {
        var gameSocket = io('http://localhost:3000/game');
        var cnt = 2;

        gameSocket.on('connect', function() {
          gameSocket.emit('listLobbies', 'amoba');
          gameSocket.emit('createRoom', 'Lajos', 'amoba');

          // events
          gameSocket.on('updateRoomList', function(rooms) {
            console.log('rooms', rooms);
            cnt--;
            if (cnt == 0) {
              console.log('rooms before enter', rooms);
              for (key in rooms) {
                gameSocket.emit('joinRoom', 'Imre', key);
                gameSocket.emit('joinRoom', 'Imre', key);
                break;
              }
            }
          });

          gameSocket.on('joinRoomFailed', function(name) {
            console.log('joinRoomFailed with name', name);
          });

          gameSocket.on('joinRoomSuccess', function(name) {
            console.log('joinRoomSuccess with name', name);
          });
        });
      });
    </script>

    <h1>WS Test</h1>
  </body>
</html>
