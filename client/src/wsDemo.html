<!DOCTYPE html>
<html>
<head>
	<title>
		WS Demo
	</title>
</head>

<body>
<style>
.list-wrapper, .game-wrapper {
	display: none;
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" 
integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" 
crossorigin="anonymous"></script>

<script>
	$(document).ready(function() {
        let gameSocket = io('http://localhost:3000/game');
        
        gameSocket.on('connect', function () {
            console.log('Connected WS.')
		});

		gameSocket.on('updateRoomList', function (rooms) {
			let tmp = '';
			for (let room in rooms) {
                tmp += '<button type="button" class="join" data-room="' + room +'">'+ room +'</button><br>';
			}

			$('.list-wrapper .items').html(tmp);
		});

		$('#create').click( function() {
            let username = prompt('Username:');
            let roomName = prompt('Room name:');

            gameSocket.emit('createRoom', username, roomName);
            
            $('.connect-wrapper').hide();

            $('.game-wrapper').show();
		});

		$('#list').click( function() {
            $('.connect-wrapper').hide();
            $('.list-wrapper').show();
        });
        
    	$('.list-wrapper').on('click', '.join', function() {
            let username = prompt('Username:');

            gameSocket.emit('joinRoom', username, $(this).data('room'));
            
            $('.list-wrapper').hide();

            $('.game-wrapper').show();
		});
	});
   </script>

<h1>WS Demo</h1>

<div class="connect-wrapper">
    <h2>
        Join or Create game!
    </h2>

    <button type="button" id="create">Create</button>
    <button type="button" id="list">Join</button>
</div>

<div class="list-wrapper">
	<h2>
		Available rooms
	</h2>

	<div class="items">
	</div>
</div>

<div class="game-wrapper">
    <h2>
        Game
    </h2>

    <div class="players">
    </div>
</div>

</body>
</html> 